Loading arguments...
[Namespace(T_max=5.0, batch_size=16, dataset='rlv', depth=6, device='cuda', input_size=256, load_path='/home/qzt/all/save_dir/', lr=0.0001, model_name='vivit_3', num_classes=2, num_epochs=20, num_frames=16, num_workers=8, patch_size=16, ratio=0.85, save_path='/home/qzt/all/save_dir/')]
log_dir is:  logs/vivit_3_on_rlv
Loading dataset...
Calculating Clips
Preloading RLV
rlv dataset has 236523 clips in total.
Creating dataloaders...
train set loader size: 12566, val set loader size: 2218
Creating model...
model parameters:  {'Total': 2163266, 'Trainable': 2163266}
Creating optimizer...
using optimizer:  Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0001
    weight_decay: 0
)
Creating scheduler...
using scheduler:  <torch.optim.lr_scheduler.CosineAnnealingLR object at 0x7ffe1c5bcc70>
Creating criterion...
using criterion:  CrossEntropyLoss()
[31m[1mStart training![0m
TRAINING EPOCH 0...
EPOCH 0 DONE! [loss CE average: 0.264870] [highest accuracy: 1.000000] [lowest accuracy: 0.187500]

TRAINING EPOCH 1...
EPOCH 1 DONE! [loss CE average: 0.050758] [highest accuracy: 1.000000] [lowest accuracy: 0.750000]

TRAINING EPOCH 2...
EPOCH 2 DONE! [loss CE average: 0.023326] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 3...
EPOCH 3 DONE! [loss CE average: 0.013021] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 4...
EPOCH 4 DONE! [loss CE average: 0.009767] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 5...
EPOCH 5 DONE! [loss CE average: 0.008589] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 6...
EPOCH 6 DONE! [loss CE average: 0.006911] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 7...
EPOCH 7 DONE! [loss CE average: 0.006045] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 8...
EPOCH 8 DONE! [loss CE average: 0.005437] [highest accuracy: 1.000000] [lowest accuracy: 0.937500]

TRAINING EPOCH 9...
EPOCH 9 DONE! [loss CE average: 0.004933] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

[33m[1mevaluating for epoch 10...[0m
[32m[1mlogging...[0m

For epoch 10, accuracy=0.9981966018676758, precision=0.9973583817481995, recall=0.9993959069252014, f1=0.9982770085334778

TRAINING EPOCH 10...
EPOCH 10 DONE! [loss CE average: 0.004544] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 11...
EPOCH 11 DONE! [loss CE average: 0.004263] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 12...
EPOCH 12 DONE! [loss CE average: 0.004211] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 13...
EPOCH 13 DONE! [loss CE average: 0.004239] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 14...
EPOCH 14 DONE! [loss CE average: 0.003242] [highest accuracy: 1.000000] [lowest accuracy: 0.875000]

TRAINING EPOCH 15...
EPOCH 15 DONE! [loss CE average: 0.003613] [highest accuracy: 1.000000] [lowest accuracy: 0.937500]

TRAINING EPOCH 16...
EPOCH 16 DONE! [loss CE average: 0.003340] [highest accuracy: 1.000000] [lowest accuracy: 0.937500]

TRAINING EPOCH 17...
EPOCH 17 DONE! [loss CE average: 0.003108] [highest accuracy: 1.000000] [lowest accuracy: 0.937500]

TRAINING EPOCH 18...
EPOCH 18 DONE! [loss CE average: 0.002683] [highest accuracy: 1.000000] [lowest accuracy: 0.937500]

TRAINING EPOCH 19...
EPOCH 19 DONE! [loss CE average: 0.003114] [highest accuracy: 1.000000] [lowest accuracy: 0.937500]

[33m[1mevaluating for epoch 20...[0m
[32m[1mlogging...[0m

For epoch 20, accuracy=0.9990137219429016, precision=0.9994233250617981, recall=0.9987279772758484, f1=0.9990149736404419

Saving...
[31m[1mAll done![0m
